const ROW_SELECTOR="tr:not(table table tr)";let settings,whiteElements,blackElements,defaults={indicatorAsc:"ᐃ",indicatorDsc:"ᐁ",sortHint:"Sort the table by clicking on a column heading.",restoreHint:"Restore the original order by clicking <button>Restore Order</button>.",whiteList:"",blackList:""};function getArray(e){return e&&"string"==typeof e||e instanceof String?e.split(","):e||[]}function isWhitelisted(e){return!whiteElements.size||whiteElements.has(e)}function isBlacklisted(e){return!!e.classList.contains("no-so")||blackElements.has(e)}function setConfig(e){settings=Object.assign({},defaults,e),whiteElements=new Set,blackElements=new Set;for(let e of getArray(settings.whiteList))for(let t of document.querySelectorAll(e))whiteElements.add(t);for(let e of getArray(settings.blackList))for(let t of document.querySelectorAll(e))blackElements.add(t)}function getIndexedRowValue(e,t){return e.children[t].innerText||e.children[t].textContent}function getColumnIndex(e){return Array.from(e.parentNode.children).indexOf(e)}function getColumn(e,t){return Array.from(e.querySelectorAll("tr")).map(e=>e.children[t])}function canColumnSort(e){return!e.length||"TH"==e[0].tagName}function getBodyRowsContainer(e){let t=e.querySelector("tbody");return t||e}function getBodyRows(e){let t=getBodyRowsContainer(e);return Array.from(t.querySelectorAll(ROW_SELECTOR)).filter(e=>!e.querySelector("th:not(table table th)"))}function getCellValue(e){return e.innerText||e.textContent}function compareValues(e,t){return isNaN(e)||isNaN(t)?String(e).localeCompare(String(t)):e-t}function isColumnAsc(e){let t=e.filter(e=>"TH"!=e.tagName).map(e=>getCellValue(e)),r=[...t].sort(compareValues);return String(t)==String(r)}function comparer(e,t){return function(r,n){return compareValues(getIndexedRowValue(t?r:n,e),getIndexedRowValue(t?n:r,e))}}function clearTableSortIndication(e){e.querySelectorAll("th.sotable-column:not(table table th)").forEach(e=>{e.classList.remove("asc"),e.classList.remove("dsc"),e.ariaSort=null,e.querySelectorAll(".indicator").forEach(e=>e.remove())})}function indicateColumnSortDirection(e,t,r){clearTableSortIndication(e);let n=document.createElement("span");t.firstChild.appendChild(n),n.classList.add("indicator"),n.ariaHidden=!0,r?(t.classList.add("asc"),t.ariaSort="ascending",n.innerHTML=settings.indicatorAsc):(t.classList.add("dsc"),t.ariaSort="descending",n.innerHTML=settings.indicatorDsc),indicateRestoreTableOrder(e)}function storeOrigTableOrder(e){let t=1;getBodyRows(e).forEach(e=>{e.querySelector("[orig-order]:not(table table [orig-order])")||(e.setAttribute("orig-order",t),t++)})}function restoreOrigTableOrder(e){clearTableSortIndication(e);let t=getBodyRowsContainer(e);Array.from(t.querySelectorAll("[orig-order]:not(table table [orig-order])")).sort((e,t)=>parseInt(e.getAttribute("orig-order"))-parseInt(t.getAttribute("orig-order"))).forEach(e=>t.appendChild(e))}function indicateRestoreTableOrder(e){e.querySelectorAll("caption p.indicator:not(table table caption p.indicator)").forEach(t=>{!t.querySelector(".restore-hint")&&settings.restoreHint&&(t.innerHTML+=` <span class="restore-hint">${settings.restoreHint}</span>`,t.querySelectorAll(".restore-hint button").forEach(t=>{t.classList.add("restore-order"),t.addEventListener("click",()=>{restoreOrigTableOrder(e)})}))})}function indicateSortableTable(e){let t=e.querySelector("caption:not(table table caption)");t||(t=document.createElement("caption"),e.prepend(t));let r=e.querySelector("p.indicator:not(table table p.indicator)");r||((r=document.createElement("p")).classList.add("indicator"),r.innerHTML=settings.sortHint,t.appendChild(r)),indicateRestoreTableOrder(e)}function insertColumnSortToggle(e){return e.querySelectorAll(":not(abbr):not(b):not(br):not(cite):not(code):not(em):not(i):not(img):not(kbd):not(label):not(mark):not(small):not(span):not(strong):not(sub):not(sup):not(svg):not(time)").length?null:(e.innerHTML=`<button>${e.innerHTML}</button>`,e.firstChild)}function sotable(e){setConfig(e),document.querySelectorAll("tr:first-child>th:not(.no-so)").forEach(e=>{let t=e.closest("table");if(!isBlacklisted(t)&&isWhitelisted(t)){let r=getColumnIndex(e);if(canColumnSort(getColumn(t,r))){storeOrigTableOrder(t);let n=insertColumnSortToggle(e);n&&(e.classList.add("sotable-column"),t.classList.add("sotable"),indicateSortableTable(t),n.addEventListener("click",()=>{let n=!isColumnAsc(getColumn(t,r)),o=getBodyRowsContainer(t);getBodyRows(t).sort(comparer(getColumnIndex(e),n)).forEach(e=>o.appendChild(e)),indicateColumnSortDirection(t,e,n)}))}}})}try{module&&module.exports&&(module.exports.sotable=sotable,module.exports.run=sotable)}catch(e){}